<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Command line Extract &mdash; CmonCrawl 1.0.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=8d563738"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../_static/copybutton.js?v=f281be69"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Extraction" href="../extraction/index.html" />
    <link rel="prev" title="Command Line Download" href="download.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            CmonCrawl
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../usage.html">Usage</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Command Line Interface</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="cli.html">Command Line Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="download.html">Command Line Download</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Command line Extract</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#positional-arguments">Positional arguments</a></li>
<li class="toctree-l3"><a class="reference internal" href="#optional-arguments">Optional arguments</a></li>
<li class="toctree-l3"><a class="reference internal" href="#record-arguments">Record arguments</a></li>
<li class="toctree-l3"><a class="reference internal" href="#html-arguments">Html arguments</a></li>
<li class="toctree-l3"><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../extraction/index.html">Extraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../prog_guide/index.html">Programming Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/index.html">Miscellaneous</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">CmonCrawl</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Command Line Interface</a></li>
      <li class="breadcrumb-item active">Command line Extract</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/cli/extract.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="command-line-extract">
<h1>Command line Extract<a class="headerlink" href="#command-line-extract" title="Link to this heading"></a></h1>
<p>The extract mode of the <code class="docutils literal notranslate"><span class="pre">cmon</span></code> command line tool serves to extract data from your downloaded files.
The following arguments are needed in this order:</p>
<section id="positional-arguments">
<h2>Positional arguments<a class="headerlink" href="#positional-arguments" title="Link to this heading"></a></h2>
<ol class="arabic simple">
<li><p>config_path - Path to the config file containing extraction rules.</p></li>
<li><p>output_path - Path to the output directory.</p></li>
<li><p>{record,html} - Extraction mode:</p>
<ul class="simple">
<li><p>record: Extract data from jsonl (domain record) files.</p></li>
<li><p>html: Extract data from HTML files.</p></li>
</ul>
</li>
<li><p>files - Files to extract data from (Either HTML files or .jsonl files).</p></li>
</ol>
<p>To create a config file, see <a class="reference internal" href="../extraction/config_file.html#extractor-config"><span class="std std-ref">Extractor config file</span></a>.</p>
<p>Both modes yield the same output format, which is a <code class="docutils literal notranslate"><span class="pre">.jsonl</span></code> file containing the extracted data,
one per line. For each file, a new directory is created in the output directory, named after the
file.</p>
<p>The files created by the download mode can be directly used with the appropriate mode
in the extraction.</p>
<ul class="simple">
<li><p>If you have an HTML file, you can use the HTML mode to extract it.</p></li>
<li><p>If you have a domain records, you can use the RECORD mode to extract it.</p></li>
<li><p>If you have domain records, which you acquired without using cmoncrawl,</p></li>
</ul>
<p>please refer to <a class="reference internal" href="../misc/domain_record.html#domain-record-jsonl"><span class="std std-ref">Domain Record JSONL format</span></a>, which describes how to create <code class="docutils literal notranslate"><span class="pre">.jsonl</span></code> files from your domain records,
which you can then use with the record mode.</p>
</section>
<section id="optional-arguments">
<h2>Optional arguments<a class="headerlink" href="#optional-arguments" title="Link to this heading"></a></h2>
<dl class="option-list">
<dt><kbd><span class="option">--max_crawls_per_file <var>MAX_CRAWLS_PER_FILE</var></span></kbd></dt>
<dd><p>Max number of extractions per file output.</p>
</dd>
<dt><kbd><span class="option">--max_directory_size <var>MAX_DIRECTORY_SIZE</var></span></kbd></dt>
<dd><p>Max number of extraction files per directory.</p>
</dd>
<dt><kbd><span class="option">--n_proc <var>N_PROC</var></span></kbd></dt>
<dd><p>Number of processes to use for extraction. The parallelization is on file level,
thus for a single file, it’s useless to use more than one process.</p>
</dd>
</dl>
</section>
<section id="record-arguments">
<h2>Record arguments<a class="headerlink" href="#record-arguments" title="Link to this heading"></a></h2>
<dl class="option-list">
<dt><kbd><span class="option">--max_retry <var>MAX_RETRY</var></span></kbd></dt>
<dd><p>Max number of WARC download attempts.</p>
</dd>
<dt><kbd><span class="option">--download_method <var>DOWNLOAD_METHOD</var></span></kbd></dt>
<dd><p>Method for downloading warc files from Common Crawl, it only applies to HTML download.</p>
<ul class="simple">
<li><p>api: Download from Common Crawl API Gateway. This is the default option.</p></li>
<li><p>s3: Download from Common Crawl S3 bucket. This is the fastest option, but requires AWS credentials with correct permissions.</p></li>
</ul>
</dd>
<dt><kbd><span class="option">--sleep_base <var>SLEEP_BASE</var></span></kbd></dt>
<dd><p>Base value for exponential backoff between failed requests.</p>
</dd>
<dt><kbd><span class="option">--max_requests_per_second <var>MAX_REQUESTS_PER_SECOND</var></span></kbd></dt>
<dd><p>Max number of requests per second.</p>
</dd>
</dl>
</section>
<section id="html-arguments">
<h2>Html arguments<a class="headerlink" href="#html-arguments" title="Link to this heading"></a></h2>
<dl class="option-list">
<dt><kbd><span class="option">--date <var>DATE</var></span></kbd></dt>
<dd><p>Date of extraction of HTML files in ISO format (e.g., 2021-01-01). The default is today.</p>
</dd>
<dt><kbd><span class="option">--url <var>URL</var></span></kbd></dt>
<dd><p>URL from which the HTML files were downloaded. By default, it will try to infer from the file content.</p>
</dd>
</dl>
</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Link to this heading"></a></h2>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Take the domain records downloaded using the first command and extracts them using your extractors</span>
cmon<span class="w"> </span>extract<span class="w"> </span>config.json<span class="w"> </span>extracted_output<span class="w"> </span>dr_output/*.jsonl<span class="w"> </span>record<span class="w"> </span>--max_retry<span class="w"> </span><span class="m">100</span><span class="w"> </span>--download_method<span class="o">=</span>gateway<span class="w"> </span>--sleep_base<span class="w"> </span><span class="m">1</span>.3

<span class="c1"># Take the htmls downloaded using the second command and extracts them using your extractors</span>
cmon<span class="w"> </span>extract<span class="w"> </span>config.json<span class="w"> </span>extracted_output<span class="w"> </span>html_output/*.html<span class="w"> </span>html<span class="w"> </span>--date<span class="w"> </span><span class="m">2021</span>-01-01<span class="w"> </span>--url<span class="w"> </span>https://www.example.com
</pre></div>
</div>
<p>When you are going to build the extractors, you will appreciate that you can specify
what the URL of the HTML file is and what the date of the extraction is. This is because
those information are used during the extractor routing.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="download.html" class="btn btn-neutral float-left" title="Command Line Download" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../extraction/index.html" class="btn btn-neutral float-right" title="Extraction" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Hynek Kydlíček.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>